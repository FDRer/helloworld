<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>灰度照片</title>
</head>
<body>
	<canvas id="canvas" width="600" height="600" style="border: 1px solid #000"></canvas>
	<script>
		var canvas = document.getElementById('canvas');
		if(canvas.getContext){
			var ctx = canvas.getContext('2d');
			var img = new Image();
			img.src = 'img/01.png';
			img.onload = function(){
				ctx.drawImage(img,0,0);
				var imgdata = ctx.getImageData(0,0,300,180);
				var pixels = imgdata.data;
				//遍历像素
				for(var i=0,n=pixels.length;i<n;i+=4){
					var grayscale = pixels[i]*.3+pixels[i+1]*.59+pixels[i+2]*.11;

					pixels[i] = grayscale;//red
					pixels[i+1] = grayscale;//green
					pixels[i+2] = grayscale;//blue
				}
				ctx.putImageData(imgdata,0,180);
			}
		}
	</script>
</body>
</html>